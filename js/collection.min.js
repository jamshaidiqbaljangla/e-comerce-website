document.addEventListener('DOMContentLoaded',()=>{const urlParams=new URLSearchParams(window.location.search);const collectionId=urlParams.get('id');if(collectionId){loadCollectionPage(collectionId);}else{displayError("No collection specified.");}});async function loadCollectionPage(collectionId){if(typeof API==='undefined'){console.error('API object not found. Make sure api.js is loaded.');displayError('Required API script not loaded.');return;}const collection=await API.getCollectionById(collectionId);if(!collection){displayError(`Collection with ID ${collectionId}not found.`);return;}updateCollectionInfo(collection);loadCollectionProducts(collection.products);}function updateCollectionInfo(collection){document.getElementById('collection-title').textContent=collection.name;document.getElementById('collection-breadcrumb').textContent=collection.name;const descriptionContainer=document.getElementById('collection-description');descriptionContainer.querySelector('h2').textContent=collection.name;descriptionContainer.querySelector('p').textContent=collection.description;const imageElement=document.getElementById('collection-image');if(collection.imageUrl){imageElement.src=collection.imageUrl;imageElement.alt=collection.name;}}function loadCollectionProducts(products){const productGrid=document.getElementById('collection-product-grid');productGrid.innerHTML='';if(!products||products.length===0){productGrid.innerHTML='<p>No products found in this collection.</p>';document.getElementById('results-count').textContent=0;return;}document.getElementById('results-count').textContent=products.length;products.forEach(product=>{const productCard=createProductCard(product);productGrid.appendChild(productCard);});}function displayError(message){const container=document.querySelector('.shop-page .container');container.innerHTML=`<p class="error-message">${message}</p>`;}function createProductCard(product){const card=document.createElement('div');card.className='product-card';card.innerHTML=`<div class="product-image"><a href="product.html?id=${product.id}"><img src="${product.imageUrl}" alt="${product.name}"></a><div class="product-actions"><a href="#" class="action-btn"><i class="fas fa-heart"></i></a><a href="#" class="action-btn"><i class="fas fa-shopping-cart"></i></a></div></div><div class="product-info"><h3 class="product-title"><a href="product.html?id=${product.id}">${product.name}</a></h3><p class="product-price">$${product.price.toFixed(2)}</p></div>`;return card;}